该项目旨在开发一个名为LAE的个人自我调节系统，其核心理念是实现一个**“记录→分析→预测→干预”的完整闭环**，以帮助用户更好地理解自身状态并采取积极行动。

# 1. 项目背景与核心要素
核心功能:状态记录： 综合用户手动输入（如情绪、精力）和电子设备被动数据（如屏幕使用情况、睡眠质量、心率），形成对用户状态的全面认知。
活动推荐与主支线管理： 基于用户当前的多维度状态以及活动进度与计划，从结构化数据库中智能推荐最适合的活动，并辅助用户管理时间与状态。
行为干预： 根据预设规则（例如，检测到用户深夜使用特定娱乐应用），主动进行提醒、警告甚至锁屏等干预措施。
平台架构: 系统将构建于一个多平台生态系统之上，包括 Windows 电脑、移动端设备（Android 手机，未来可扩展至 iOS 手机） 和 Fitbit 手表 [1, 您的查询]。
Windows 电脑 将作为系统的核心“大脑”，负责运行数据处理、模型分析和决策引擎等复杂脚本。这些复杂脚本将由 Python 后端 实现 [1, 2, 您的查询]。
移动端设备（Android 手机，未来可扩展至 iOS 手机） 将作为主要的 用户交互界面。具体而言，您将使用 Flutter 开发移动端应用，负责用户状态的手动输入、接收推荐和干预指令的展示。Flutter 的跨平台特性使得未来向 iOS 扩展成为可能。
Fitbit 手表 依然作为主要的 被动数据采集端点。
当前阶段: 处于 概念验证和原型（Demo）开发阶段。
重点是设计和验证整套系统的 核心规则与机制，而非实现复杂的数据链路。
在当前阶段，系统将大量使用 手动输入 作为自动化传感器数据的占位符，以证明整个逻辑闭环的可行性。
# 2. 项目目标与核心原则
目标： 构建一个以规则和机制为核心，贯通记录-分析-预测-干预全流程，涉及电脑、手机、手表的概念验证原型。
核心原则： 重逻辑，轻链路。手动输入是可接受的模拟，为未来自动化留好接口。
# 3. 长期开发计划

本计划旨在为项目提供一个为期数月的宏观路线图。每个阶段的具体任务和时间安排将在 `docs/weekly_develop_plan.md` 中详细制定。项目将采用迭代式开发，先构建最小可用框架，再逐步扩展。

---

### **阶段一：基础框架与最小可行产品 (MVP) (探索期) 7.13-8.2 3W**

**目标：** 搭建一个贯穿PC端、云端和移动端的最小化但完整的工作流，验证核心技术选型，并建立开发规范。

1.  **基础架构搭建**:
    *   **数据库**: 定义并创建最核心的数据表（如用户状态、活动日志），同时在本地SQLite和Supabase中建立。
    *   **云端通信**: 实现PC端Python脚本与Supabase之间最基础的数据同步（PC推送决策，拉取输入）。
    *   **移动端骨架**: 创建一个基础的Flutter应用，能连接到Supabase，并包含一个用于手动输入的表单和一个用于显示结果的简单页面。
2.  **核心功能模块 (简化版)**:
    *   实现一个简单的“输入→分析→推荐”闭环。例如：用户在手机端输入“精力低”，PC端引擎分析后，在手机端推荐“休息10分钟”。
3.  **开发流程固化**:
    *   建立代码版本控制、文档记录 (`CHANGELOG.md`, `weekly_develop_plan.md`) 和任务管理的习惯。

**产出**: 一个可以跑通数据流的“骨架”系统。虽然功能极简，但证明了PC、云、移动端三者可以协同工作，并确立了后续开发的流程。

---

### **阶段二：迭代开发与试用优化 (扩张期) 8.3-8.17 2W**

**目标：** 在现有框架上，通过小步快跑的方式，不断增加新功能、丰富数据维度，并根据实际使用体验进行优化。

1.  **功能迭代**:
    *   **增加数据表**: 根据需要，逐步增加新的数据表（如习惯追踪、项目管理等）并完善其同步逻辑。
    *   **丰富功能模块**: 在基础闭环之上，添加更复杂的功能，如历史数据分析、带权重的活动推荐、简单的干预提醒等。
2.  **试用与反馈**:
    *   **个人试用**: 将应用作为个人日常工具进行长期使用，记录问题和体验不佳之处。
    *   **持续优化**: 根据试用反馈，定期调整UI/UX、优化后端算法、修复Bug。

**产出**: 一个功能日益丰富且在真实使用场景中不断打磨的、稳定可用的个人调节系统。

---

### **阶段三：演示、推广与平台扩展 (成熟期) 8.17-9.7 3W**

**目标：** 准备一个可对外展示的成熟版本，并为未来的进一步发展规划方向。

1.  **Demo准备**:
    *   **功能梳理**: 整合并打磨现有核心功能，形成一个流畅、有说服力的演示流程。
    *   **文档完善**: 准备项目介绍、架构说明和成果展示材料，用于向导师或相关人士汇报。
2.  **推广与扩展规划**:
    *   **方向探索**: 思考项目未来的应用场景和潜在的推广价值。
    *   **平台扩展**: 启动对新平台（如iOS、Fitbit原生集成）的技术预研和初步开发。

**产出**: 一个可随时演示的项目Demo、一套完整的项目文档，以及一份清晰的未来发展路线图。

---

# LAE项目结构

## AI自动更新指令 (Auto-Update Prompt)

```
当需要更新项目结构时，请执行以下操作：
1. 扫描指定的文件夹（默认扫描整个LAE根目录），读取对应文件夹中的文件内容（尤其是文件开头可能有的文件说明注释）
2. 更新本文档中对应的文件夹和文件描述
3. 保持现有的文档格式和结构
4. 如有新增文件或文件夹，请按照现有模式添加描述
5. 可通过参数指定扫描范围，例如：
   - 仅扫描 src/ 文件夹
   - 仅扫描 lae_app/ 文件夹
   - 仅扫描 database/ 文件夹
6. 更新完成后，请在文档末尾添加更新时间戳

使用示例：
- "更新整个项目结构"
- "仅更新src文件夹的结构"
- "更新lae_app文件夹的Flutter项目结构"
```

---

## 项目整体概述

LAE是一个个人自我调节系统，实现"记录→分析→预测→干预"的完整闭环。项目采用多平台架构，包含Python后端、Flutter移动端和数据库组件。

---

## 项目结构

```
LAE-System/
├── .fvm/                     <-- Flutter版本管理工具配置
├── .fvmrc                    <-- FVM配置文件
├── .git/                     <-- Git仓库，版本控制
├── .gitignore                <-- Git忽略文件配置
├── .vs/                      <-- Visual Studio配置文件夹
├── venv/                     <-- Python虚拟环境
├── database/
│   ├── data_base.db          <-- SQLite数据库文件
│   └── schema.sql            <-- 数据表结构定义
├── docs/
│   ├── quest_objective_system_design.md <-- 主支线任务与目标系统的设计文档
│   ├── weekly_develop_plan.md <-- 本周详细开发计划和任务拆解
├── lae_app/                  <-- Flutter移动端应用
│   ├── .dart_tool/           <-- Dart工具缓存
│   ├── .flutter-plugins      <-- Flutter插件配置
│   ├── .flutter-plugins-dependencies <-- 插件依赖
│   ├── .gitignore            <-- Flutter项目Git忽略配置
│   ├── .idea/                <-- IDE配置文件夹
│   ├── .metadata             <-- Flutter元数据
│   ├── analysis_options.yaml <-- Dart代码分析配置
│   ├── lae_app.iml           <-- IntelliJ模块文件
│   ├── pubspec.yaml          <-- Flutter项目依赖配置
│   ├── pubspec.lock          <-- 依赖锁定文件
│   ├── README.md             <-- Flutter应用说明
│   ├── android/              <-- Android平台配置
│   ├── build/                <-- 构建输出目录
│   ├── ios/                  <-- iOS平台配置
│   ├── lib/
│   │   ├── models/
│   │   │   └── status_record.dart <-- 状态记录数据模型
│   │   ├── pages/
│   │   │   ├── records_display_page.dart <-- 历史记录展示UI页面
│   │   │   └── status_survey_page.dart <-- 状态问卷UI页面
│   │   ├── services/
│   │   │   ├── database_helper.dart <-- 本地数据库辅助类
│   │   │   └── notification_service.dart <-- 本地通知服务类
│   │   └── main.dart         <-- Flutter应用主入口
│   ├── linux/                <-- Linux平台配置
│   ├── macos/                <-- macOS平台配置
│   ├── test/                 <-- 测试文件目录
│   ├── web/                  <-- Web平台配置
│   └── windows/              <-- Windows平台配置
├── prompts/
│   └── prompts.md            <-- AI指令库，存储项目相关的AI提示词
├── src/
│   └── supabase_client.py    <-- 核心Python脚本，处理数据同步
├── CHANGELOG.md              <-- 项目开发日志和版本记录
└── README.md                 <-- 项目整体说明，项目结构和入门指南
```


---

## 核心文件和文件夹详细说明

### 1. 数据库层 (`database/`)
- **`schema.sql`**: 定义系统的数据表结构，包括用户状态表、活动表、规则表等。
- **`data_base.db`**: 本地SQLite数据库文件，存储实际的业务数据。

### 2. 后端核心 (`src/`)
- **`supabase_client.py`**: 系统的"大脑"，负责：
  - 数据处理和分析
  - 状态评估算法
  - 活动推荐逻辑
  - 干预决策引擎
  - 与Supabase云服务的数据同步

### 3. 移动端应用 (`lae_app/`)
Flutter跨平台移动应用，主要功能：
- **`lib/main.dart`**: 应用主入口，负责初始化、定义应用结构和路由。
- **`lib/models/`**: 存放数据模型类。
  - **`status_record.dart`**: 定义状态记录的数据结构，包含睡眠、各项状态评分、饮食、备注等字段。
- **`lib/pages/`**: 存放应用的所有UI页面。
  - **`status_survey_page.dart`**: 每日状态问卷的UI界面，使用单选、滑块和文本框等多种控件收集用户输入。
  - **`records_display_page.dart`**: 用于从本地数据库读取并以列表和弹窗形式展示历史状态记录的UI界面。
- **`lib/services/`**: 存放后台服务类，如API请求、数据库操作、通知等。
  - **`database_helper.dart`**: 本地SQLite数据库的辅助类，封装了数据库的初始化和对`status_records`表的CRUD操作。
  - **`notification_service.dart`**: 负责处理本地定时通知的创建和调度。
- **用户界面**: 状态输入、活动展示、干预提醒等。
- **数据交互**: 与后端Python脚本的数据交换。
- **多平台支持**: Android、iOS、Web、Desktop。

### 4. 文档系统 (`docs/`)
- **`weekly_develop_plan.md`**: 详细的开发计划和阶段性目标。
- **`quest_objective_system_design.md`**: 主支线任务与目标系统的设计文档。

### 5. AI工具集 (`prompts/`)
- **`prompts.md`**: 存储项目开发过程中使用的AI提示词和指令模板。

### 6. 项目管理文件
- **`README.md`**: 项目概览、核心理念、架构说明。
- **`CHANGELOG.md`**: 记录每个版本的更新内容和开发进展。
- **`.gitignore`**: 定义Git版本控制忽略的文件和目录。

### 7. 开发环境配置
- **`venv/`**: Python虚拟环境，隔离项目依赖。
- **`.fvm/` & `.fvmrc`**: Flutter版本管理，确保团队开发一致性。
- **`.vs/`**: Visual Studio IDE配置文件

---


*最后更新时间: 2025-07-28*